<!DOCTYPE html>
<html>
	<head>
        <meta charset="utf-8">
        <link href="../../../css/styles.css" rel="stylesheet">
        <title>Многопоточность. C#</title>
    </head>
    <body>
		<div class="header">
			<div class="image">
				<img class="image" src="../../icon.png"></image>
			</div>
			<div class="title">
				<a>IMPROVE YOURSELF</a>
			</div>
		</div>
		<div class="topics">
			<ul class="nav">
				<li>
					<a href="../../topicsView.html"><b>C#</b></a>
					<a href="../ClassesAndObjects/content.html">Классы</a>
					<a href="#">Делегаты</a>
				</li>
			</ul>
		</div>
        <div class="content">
			<div class="content_wrapper">
				<div class="topic_title_info">
					<ul class="topic_title_info_list">
						<li>
							<a>от: Max</a>
							<a>"29 августа 2020 года"</a>
						</li>
					</ul>
					<h2 class="topic_title_header">Асинхронное программирование</h2>
					<img class="topic_title_info_image" src="title.jpg"></img>
				</div>
				<div class="article">
					<p>Асинхронность позволяет вынести отдельные задачи из основного потока в специальные асинхронные методы или блоки кода. 
					Особенно это актуально в графических программах, где продолжительные задачи могу блокировать интерфейс пользователя. 
					И чтобы этого не произошло, нужно задействовать асинхронность. Также асинхронность несет выгоды в веб-приложениях при обработке запросов от пользователей, при обращении к базам данных или сетевым ресурсам. При больших запросах к базе данных асинхронный метод просто уснет на время, пока не получит данные от БД, а основной поток сможет продолжить свою работу. 
					В синхронном же приложении, если бы код получения данных находился в основном потоке, этот поток просто бы блокировался на время получения данных.
					Ключевыми для работы с асинхронными вызовами в C# являются два ключевых слова: async и await, цель которых - упростить написание асинхронного кода. 
					Они используются вместе для создания асинхронного метода.
					<p><span class="b">Асинхонный метод</span> обладает следующими признаками:</p>
					<div class="list_style">
						<ul>
							<li><p>В заголовке метода используется модификатор <span class="b">async</span></p></li>
							<li><p>Метод содержит одно или несколько выражений <span class="b">await</span></p></li>
							<li>
								<p>В качестве возвращаемого типа используется один из следующих:
									<ul style="margin-left:25px;">
										<li>void</li>
										<li>Task</li>
										<li>Task&ltT&gt</li>
										<li>ValueTask&ltT&gt</li>
									</ul>
								</p>
							</li>
						</ul>
					</div>
					<p>Асинхронный метод, как и обычный, может использовать любое количество параметров или не использовать их вообще. 
					Однако асинхронный метод не может определять параметры с модификаторами <span class="b">out</span> и <span class="b">ref</span>. 
					Также стоит отметить, что слово <span class="b">async</span>, которое указывается в определении метода, не делает автоматически метод асинхронным. 
					Оно лишь указывает, что данный метод может содержать одно или несколько выражений <span class="b">await</span>.
					</p>
					<p>Рассмотрим пример асинхронного метода:</p>
					<div class="demo">
						<input type="checkbox" id="show_code" class="hide"/>
						<label div id="button" for="show_code">Показать код</label>
						<div>
							<pre>
using System;
using System.Threading;
using System.Threading.Tasks;
 
namespace HelloApp
{
    class Program
    {
        static void Factorial()
        {
            int result = 1;
            for(int i = 1; i <= 6; i++)
            {
                result *= i;
            }
            Thread.Sleep(8000);
            Console.WriteLine($"Факториал равен {result}");
        }
        // определение асинхронного метода
        static async void FactorialAsync()
        {
            Console.WriteLine("Начало метода FactorialAsync"); // выполняется синхронно
            await Task.Run(()=>Factorial());                // выполняется асинхронно
            Console.WriteLine("Конец метода FactorialAsync");
        }
 
        static void Main(string[] args)
        {
            FactorialAsync();   // вызов асинхронного метода
 
            Console.WriteLine("Введите число: ");
            int n = Int32.Parse(Console.ReadLine());
            Console.WriteLine($"Квадрат числа равен {n * n}");
             
            Console.Read();
        }
    }
}
</pre>   
						</div>
					</div>
					<p>Здесь прежде всего определен обычный метод подсчета факториала. Для имитации долгой работы в нем используется задержка на 8 секунд с помощью метода Thread.Sleep(). 
					Условно это некоторый метод, который выполняет некоторую работу продолжительное время. Но для упрощения понимания он просто подсчитывает факториал числа 6.
					Также здесь определен асинхронный метод FactorialAsync(). 
					Асинхронным он является потому, что имеет в определении перед возвращаемым типом модификатор <span class="b">async</span>, его возвращаемым типом является <span class="b">void</span>, и в теле метода определено выражение <span class="b">await</span>.
					Выражение <span class="b">await</span> определяет задачу, которая будет выполняться асинхронно. В данном случае подобная задача представляет выполнение функции факториала:
					</p>
					<div class="demo">
						<input type="checkbox" id="show_code" class="hide"/>
						<label div id="button" for="show_code">Показать код</label>
						<div>
							<pre>
await Task.Run(()=>Factorial());
</pre>   
						</div>
					</div>
				</div>
			</div>
		</div>
		<div id="about">
			<p>Контакты для связи: mari.kolesnikova.01@list.ru, super.kiz2016@yandex.ru</p>
			<p>Copyright © Programming.com, 2020</p>
		</div>
    </body>
</html>